var en = {
	"gui.extension.spikeprime.name": "LEGO Education SPIKE Prime",
	"gui.extension.spikeprime.description": "Build with SPIKE Prime or Robot Inventor (legacy v. 2 firmware with bluetooth classic). Supports motors, sensors, lights, and displays.",
	"gui.extension.spikeprime.connectingMessage": "Connecting to SPIKE Prime..."
};
var de = {
	"gui.extension.spikeprime.name": "LEGO Education SPIKE Prime",
	"gui.extension.spikeprime.description": "Baue mit SPIKE Prime or Robot Inventor (alte Firmware Version 2.x). UnterstÃ¼tzt Motoren, Sensoren, Lichter und Displays.",
	"gui.extension.spikeprime.connectingMessage": "Verbinde mit SPIKE Prime..."
};
var fr = {
	"gui.extension.spikeprime.name": "LEGO Education SPIKE Prime",
	"gui.extension.spikeprime.description": "Construisez avec SPIKE Prime ou Robot Inventor (v. 2 firmware). Prend en charge les moteurs, capteurs, lumiÃ¨res et Ã©crans.",
	"gui.extension.spikeprime.connectingMessage": "Connexion Ã  SPIKE Prime..."
};
var translations = {
	en: en,
	de: de,
	fr: fr
};

var img$2 = "data:image/png;base64,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";

var img$1 = "data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='40px' height='40px' viewBox='0 0 40 40' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3ctitle%3espikeprime-small%3c/title%3e %3cg id='spikeprime-small' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3crect id='body' stroke='%237C87A5' fill='white' x='9.5' y='4.5' width='21' height='31' rx='1.5'%3e%3c/rect%3e %3cg id='matrix' transform='translate(13.000000%2c 12.000000)' fill='%23FFD500'%3e %3crect id='d' x='6' y='3' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy' x='9' y='3' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-3' x='6' y='6' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-2' x='9' y='6' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-11' x='0' y='3' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-10' x='3' y='3' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-9' x='0' y='6' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-8' x='3' y='6' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-15' x='12' y='3' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-14' x='3' y='9' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-13' x='12' y='6' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-12' x='6' y='12' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-16' x='3' y='0' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-17' x='9' y='0' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-5' x='6' y='9' width='2' height='2'%3e%3c/rect%3e %3crect id='d-copy-4' x='9' y='9' width='2' height='2'%3e%3c/rect%3e %3c/g%3e %3ccircle id='Oval' stroke='%234C97FF' cx='26.5' cy='8.5' r='1.5'%3e%3c/circle%3e %3ccircle id='Oval-Copy' stroke='%237C87A5' cx='20' cy='31' r='2.5'%3e%3c/circle%3e %3c/g%3e%3c/svg%3e";

var img = "data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='79px' height='123px' viewBox='0 0 79 123' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3ctitle%3espikeprime-illustration%3c/title%3e %3cg id='spikeprime-illustration' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='Group' transform='translate(1.000000%2c 1.000000)'%3e %3crect id='Rectangle' stroke='%237C87A5' fill='white' x='0' y='0' width='77' height='121' rx='5.5'%3e%3c/rect%3e %3ccircle id='Oval' stroke='%237C87A5' stroke-width='0.5' cx='5.5' cy='5.5' r='3.5'%3e%3c/circle%3e %3ccircle id='Oval-Copy-3' stroke='%237C87A5' stroke-width='0.5' cx='71.5' cy='5.5' r='3.5'%3e%3c/circle%3e %3ccircle id='Oval-Copy' stroke='%237C87A5' stroke-width='0.5' cx='5.5' cy='115.5' r='3.5'%3e%3c/circle%3e %3ccircle id='Oval-Copy-5' stroke='%237C87A5' stroke-width='0.5' cx='71.5' cy='115.5' r='3.5'%3e%3c/circle%3e %3cpath d='M16.5%2c99 C13.4624339%2c99 11%2c101.462434 11%2c104.5 C11%2c107.537566 13.4624339%2c110 16.5%2c110 C38.5%2c110 38.5%2c110 60.5%2c110 C63.5375661%2c110 66%2c107.537566 66%2c104.5 C66%2c101.462434 63.5375661%2c99 60.5%2c99 C38.5%2c99 38.5%2c99 16.5%2c99 Z' id='Path' stroke='%237C87A5' stroke-width='0.5'%3e%3c/path%3e %3ccircle id='Center-Button' stroke='%237C87A5' stroke-width='1.5' fill='white' cx='38.5' cy='104.5' r='10.5'%3e%3c/circle%3e %3ccircle id='Bluetooth' stroke='%234C97FF' stroke-width='1.5' cx='60.5' cy='16.5' r='6.5'%3e%3c/circle%3e %3cg id='matrix' transform='translate(12.000000%2c 34.000000)' fill='%23FFD500'%3e %3crect id='Rectangle-Copy-24' x='0' y='11' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-26' x='11' y='0' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-25' x='11' y='11' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-29' x='22' y='11' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-28' x='33' y='0' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-27' x='33' y='11' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-31' x='44' y='11' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-42' x='0' y='22' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-40' x='11' y='22' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-39' x='11' y='33' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-38' x='22' y='22' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-37' x='22' y='33' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-36' x='33' y='22' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-35' x='33' y='33' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-34' x='44' y='22' width='9' height='9'%3e%3c/rect%3e %3crect id='Rectangle-Copy-45' x='22' y='44' width='9' height='9'%3e%3c/rect%3e %3c/g%3e %3c/g%3e %3c/g%3e%3c/svg%3e";

/**
 * @param {object} messageData - data for format-message
 * @returns {string} - translated message for the current locale
 */
var formatMessage$1 = function formatMessage(messageData) {
  return messageData.defaultMessage;
};
var entry = {
  get name() {
    return formatMessage$1({
      id: 'gui.extension.spikeprime.name',
      default: 'LEGO Education SPIKE Prime',
      description: 'Name for the SPIKE Prime extension'
    });
  },
  extensionId: 'spikeprime',
  collaborator: 'CrispStrobe',
  iconURL: img$2,
  insetIconURL: img$1,
  get description() {
    return formatMessage$1({
      id: 'gui.extension.spikeprime.description',
      default: 'Build with SPIKE Prime or Robot Inventor (v. 3 firmware with BLE). Supports motors, sensors, lights, and displays.',
      description: 'Description for the SPIKE Prime extension'
    });
  },
  featured: true,
  disabled: false,
  bluetoothRequired: true,
  internetConnectionRequired: false,
  launchPeripheralConnectionFlow: true,
  useAutoScan: true,
  connectionIconURL: img,
  connectionSmallIconURL: img$1,
  get connectingMessage() {
    return formatMessage$1({
      id: 'gui.extension.spikeprime.connectingMessage',
      default: 'Connecting to SPIKE Prime (over BLE)...',
      description: 'Message shown when connecting to SPIKE Prime'
    });
  },
  helpLink: 'https://education.lego.com/',
  setFormatMessage: function setFormatMessage(formatter) {
    formatMessage$1 = formatter;
  },
  translationMap: translations
};

function _typeof(o) {
  "@babel/helpers - typeof";

  return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) {
    return typeof o;
  } : function (o) {
    return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o;
  }, _typeof(o);
}

function _assertThisInitialized(e) {
  if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return e;
}

function _possibleConstructorReturn(t, e) {
  if (e && ("object" == _typeof(e) || "function" == typeof e)) return e;
  if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined");
  return _assertThisInitialized(t);
}

function _getPrototypeOf(t) {
  return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {
    return t.__proto__ || Object.getPrototypeOf(t);
  }, _getPrototypeOf(t);
}

function _superPropBase(t, o) {
  for (; !{}.hasOwnProperty.call(t, o) && null !== (t = _getPrototypeOf(t)););
  return t;
}

function _get() {
  return _get = "undefined" != typeof Reflect && Reflect.get ? Reflect.get.bind() : function (e, t, r) {
    var p = _superPropBase(e, t);
    if (p) {
      var n = Object.getOwnPropertyDescriptor(p, t);
      return n.get ? n.get.call(arguments.length < 3 ? e : r) : n.value;
    }
  }, _get.apply(null, arguments);
}

function _setPrototypeOf(t, e) {
  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {
    return t.__proto__ = e, t;
  }, _setPrototypeOf(t, e);
}

function _inherits(t, e) {
  if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function");
  t.prototype = Object.create(e && e.prototype, {
    constructor: {
      value: t,
      writable: true,
      configurable: true
    }
  }), Object.defineProperty(t, "prototype", {
    writable: false
  }), e && _setPrototypeOf(t, e);
}

function _classCallCheck(a, n) {
  if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function");
}

function toPrimitive(t, r) {
  if ("object" != _typeof(t) || !t) return t;
  var e = t[Symbol.toPrimitive];
  if (void 0 !== e) {
    var i = e.call(t, r);
    if ("object" != _typeof(i)) return i;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return (String )(t);
}

function toPropertyKey(t) {
  var i = toPrimitive(t, "string");
  return "symbol" == _typeof(i) ? i : i + "";
}

function _defineProperties(e, r) {
  for (var t = 0; t < r.length; t++) {
    var o = r[t];
    o.enumerable = o.enumerable || false, o.configurable = true, "value" in o && (o.writable = true), Object.defineProperty(e, toPropertyKey(o.key), o);
  }
}
function _createClass(e, r, t) {
  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", {
    writable: false
  }), e;
}

function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _superPropGet(t, o, e, r) { var p = _get(_getPrototypeOf(t.prototype ), o, e); return 2 & r && "function" == typeof p ? function (t) { return p.apply(e, t); } : p; }
var BleBaseBlocks = require('./lib/ble-base-blocks');
var Hub = require('./lib/hub');
var blockIconURI = '';
var formatMessage = require('format-message');
var extensionURL = 'https://cdn.jsdelivr.net/gh/CrispStrobe/scratch-lego-bluetooth-extensions@master/dist/spikeprime_ble.mjs';

// SPIKE Prime BLE UUIDs - YOUR WORKING APPROACH
var SPIKE_PRIME_SERVICE_UUID = '0000fd02-0000-1000-8000-00805f9b34fb';
var SPIKE_PRIME_WRITE_UUID = '0000fd02-0001-1000-8000-00805f9b34fb';
var SPIKE_PRIME_NOTIFY_UUID = '0000fd02-0002-1000-8000-00805f9b34fb';

// Standard LEGO UUIDs as fallback
var LEGO_SERVICE_UUID = '00001623-1212-efde-1623-785feabcd123';
var LEGO_CHAR_UUID = '00001624-1212-efde-1623-785feabcd123';

// Constants from working BTC version
var BTSendRateMax = 40;
var SpikePorts = ['A', 'B', 'C', 'D', 'E', 'F'];
var SpikeMotorStopMode = {
  brake: 1};
var SpikeOrientation = {
  front: 1};

// SPIKE Prime Motor Settings
var SpikeMotorSetting = /*#__PURE__*/function () {
  function SpikeMotorSetting() {
    _classCallCheck(this, SpikeMotorSetting);
    this._speed = 75;
    this._stopMode = SpikeMotorStopMode.brake;
    this._stallDetection = true;
  }
  return _createClass(SpikeMotorSetting, [{
    key: "speed",
    get: function get() {
      return this._speed;
    },
    set: function set(value) {
      this._speed = this._clamp(value, -100, 100);
    }
  }, {
    key: "stopMode",
    get: function get() {
      return this._stopMode;
    },
    set: function set(value) {
      if (value >= 0 && value <= 2) this._stopMode = value;
    }
  }, {
    key: "stallDetection",
    get: function get() {
      return this._stallDetection;
    },
    set: function set(value) {
      this._stallDetection = value;
    }
  }, {
    key: "_clamp",
    value: function _clamp(value, min, max) {
      return Math.max(min, Math.min(max, value));
    }
  }]);
}(); // Complete BLE SPIKE Prime Hub
var CompleteBLESpikePrimeHub = /*#__PURE__*/function (_Hub) {
  function CompleteBLESpikePrimeHub(runtime, extensionId) {
    var _this;
    _classCallCheck(this, CompleteBLESpikePrimeHub);
    console.log('ðŸš€ CompleteBLESpikePrimeHub: Initializing...');

    // Initialize without hub type for UUID scanning
    _this = _callSuper(this, CompleteBLESpikePrimeHub, [runtime, extensionId, null]);

    // Connection state
    _this._connectionAttempts = 0;
    _this._connectionMethod = 'none';
    _this._connected = false;
    _this._useSpikePrimeUUIDs = true;

    // Communication state
    _this._remainingText = '';
    _this._openRequests = {};
    _this._requestId = 0;

    // Python REPL state
    _this._pythonAvailable = false;
    _this._sensorLoopRunning = false;
    _this._replHistory = [];
    _this._replOutput = '';

    // Sensor data
    _this._sensors = {
      buttons: [0, 0, 0, 0],
      angle: {
        pitch: 0,
        roll: 0,
        yaw: 0
      },
      acceleration: {
        x: 0,
        y: 0,
        z: 0
      },
      gyro: {
        x: 0,
        y: 0,
        z: 0
      },
      orientation: SpikeOrientation.front,
      battery: 100,
      temperature: 25,
      hubTemp: 25,
      gestures: {
        tapped: false,
        doubletapped: false,
        shake: false,
        freefall: false
      },
      motorPositions: {}
    };
    _this._portValues = {};
    _this._pixelBrightness = 100;
    _this._volume = 100;

    // Motor settings
    _this._motorSettings = {
      A: new SpikeMotorSetting(),
      B: new SpikeMotorSetting(),
      C: new SpikeMotorSetting(),
      D: new SpikeMotorSetting(),
      E: new SpikeMotorSetting(),
      F: new SpikeMotorSetting()
    };

    // Movement and timer
    _this._movementMotors = ['A', 'B'];
    _this._timer = {
      start: Date.now(),
      current: 0
    };

    // Rate limiting - safe loading
    try {
      var RateLimiter = require('../../../util/rateLimiter');
      _this._rateLimiter = new RateLimiter(BTSendRateMax);
    } catch (e) {
      _this._rateLimiter = {
        okayToSend: function okayToSend() {
          return true;
        }
      };
    }

    // Connection monitoring
    _this._keepAliveInterval = null;
    _this._lastHeartbeat = Date.now();

    // Update timer safely
    var self = _this;
    setInterval(function () {
      self._timer.current = (Date.now() - self._timer.start) / 1000;
    }, 10);
    console.log('âœ… CompleteBLESpikePrimeHub: Initialization complete');
    return _this;
  }

  // Getters
  _inherits(CompleteBLESpikePrimeHub, _Hub);
  return _createClass(CompleteBLESpikePrimeHub, [{
    key: "angle",
    get: function get() {
      return this._sensors.angle;
    }
  }, {
    key: "orientation",
    get: function get() {
      return this._sensors.orientation;
    }
  }, {
    key: "portValues",
    get: function get() {
      return this._portValues;
    }
  }, {
    key: "pixelBrightness",
    get: function get() {
      return this._pixelBrightness;
    },
    set: function set(value) {
      this._pixelBrightness = this._clamp(value, 0, 100);
    }
  }, {
    key: "motorSettings",
    get: function get() {
      return this._motorSettings;
    }
  }, {
    key: "acceleration",
    get: function get() {
      return this._sensors.acceleration;
    }
  }, {
    key: "gyro",
    get: function get() {
      return this._sensors.gyro;
    }
  }, {
    key: "battery",
    get: function get() {
      return this._sensors.battery;
    }
  }, {
    key: "temperature",
    get: function get() {
      return this._sensors.temperature;
    }
  }, {
    key: "hubTemp",
    get: function get() {
      return this._sensors.hubTemp;
    }
  }, {
    key: "gestures",
    get: function get() {
      return this._sensors.gestures;
    }
  }, {
    key: "movementMotors",
    get: function get() {
      return this._movementMotors;
    }
  }, {
    key: "timer",
    get: function get() {
      return this._timer.current;
    }
  }, {
    key: "volume",
    get: function get() {
      return this._volume;
    }
  }, {
    key: "replOutput",
    get: function get() {
      return this._replOutput;
    }
  }, {
    key: "replHistory",
    get: function get() {
      return this._replHistory;
    }

    // Override scan with UUID-first approach
  }, {
    key: "scan",
    value: function scan() {
      console.log('ðŸ” CompleteBLESpikePrimeHub: Starting BLE scan...');
      this._connectionAttempts++;
      if (this._ble) {
        console.log('ðŸ“´ CompleteBLESpikePrimeHub: Cleaning up existing connection...');
        this._ble.disconnect();
      }
      var self = this;
      return this._attemptSpikePrimeUUIDs().catch(function (error) {
        console.warn('âš ï¸ CompleteBLESpikePrimeHub: UUID method failed:', error.message);
        self._useSpikePrimeUUIDs = false;
        return self._attemptStandardLego();
      }).catch(function (error) {
        console.error('âŒ CompleteBLESpikePrimeHub: All scan methods failed:', error);
        throw error;
      });
    }
  }, {
    key: "_attemptSpikePrimeUUIDs",
    value: function _attemptSpikePrimeUUIDs() {
      console.log('ðŸŽ¯ CompleteBLESpikePrimeHub: PRIMARY - SPIKE Prime UUID scan');
      this._connectionMethod = 'spike_uuids';
      try {
        var BLE = require('../../../io/ble');
        var options = {
          filters: [{
            services: [SPIKE_PRIME_SERVICE_UUID]
          }, {
            namePrefix: 'LEGO Hub'
          }, {
            namePrefix: 'Technic Hub'
          }],
          optionalServices: [SPIKE_PRIME_SERVICE_UUID]
        };
        console.log('ðŸ“¡ CompleteBLESpikePrimeHub: SPIKE UUID scan config:', JSON.stringify(options, null, 2));
        this._ble = new BLE(this._runtime, this._extensionId, options, this._onConnect, this.reset, this._onMessage);
        console.log('âœ… CompleteBLESpikePrimeHub: SPIKE Prime UUID scanner ready');
        return Promise.resolve();
      } catch (error) {
        console.error('âŒ CompleteBLESpikePrimeHub: UUID scan setup failed:', error);
        throw error;
      }
    }
  }, {
    key: "_attemptStandardLego",
    value: function _attemptStandardLego() {
      console.log('ðŸ”„ CompleteBLESpikePrimeHub: FALLBACK - Standard LEGO scan');
      this._connectionMethod = 'standard_lego';
      try {
        var BLE = require('../../../io/ble');
        var options = {
          filters: [{
            services: [LEGO_SERVICE_UUID]
          }],
          optionalServices: [LEGO_SERVICE_UUID]
        };
        console.log('ðŸ“¡ CompleteBLESpikePrimeHub: Standard LEGO scan config:', JSON.stringify(options, null, 2));
        this._ble = new BLE(this._runtime, this._extensionId, options, this._onConnect, this.reset, this._onMessage);
        console.log('âœ… CompleteBLESpikePrimeHub: Standard LEGO scanner ready');
        return Promise.resolve();
      } catch (error) {
        console.error('âŒ CompleteBLESpikePrimeHub: Standard scan setup failed:', error);
        throw error;
      }
    }

    // Enhanced connection handler
  }, {
    key: "_onConnect",
    value: function _onConnect() {
      var timestamp = new Date().toLocaleTimeString();
      console.log('[' + timestamp + '] CompleteBLESpikePrimeHub: CONNECTION ESTABLISHED!');
      console.log('ðŸ“Š Connection details: Method=' + this._connectionMethod + ', Attempt=' + this._connectionAttempts + ', UUIDs=' + this._useSpikePrimeUUIDs);
      try {
        if (this._useSpikePrimeUUIDs) {
          console.log('ðŸŽ¯ CompleteBLESpikePrimeHub: Setting up SPIKE Prime communication...');
          this._setupSpikePrimeCommunication();
        } else {
          console.log('ðŸŽ¯ CompleteBLESpikePrimeHub: Using standard LEGO communication...');
          _superPropGet(CompleteBLESpikePrimeHub, "_onConnect", this, 3)([]);
        }

        // Start Python REPL initialization
        var self = this;
        setTimeout(function () {
          self._initializePythonREPL();
        }, 1000);

        // Start connection monitoring
        this._startConnectionMonitoring();
        this._connected = true;
        console.log('ðŸŽ‰ CompleteBLESpikePrimeHub: Connection fully established!');
      } catch (error) {
        console.error('âŒ CompleteBLESpikePrimeHub: Connection setup failed:', error);
        this.reset();
      }
    }
  }, {
    key: "_setupSpikePrimeCommunication",
    value: function _setupSpikePrimeCommunication() {
      console.log('ðŸ“¡ CompleteBLESpikePrimeHub: Configuring SPIKE Prime characteristics...');
      try {
        var self = this;

        // Start notifications
        this._ble.startNotifications(SPIKE_PRIME_SERVICE_UUID, SPIKE_PRIME_NOTIFY_UUID, function (base64) {
          self._onMessage({
            message: base64
          });
        });
        console.log('âœ… CompleteBLESpikePrimeHub: Notifications enabled');

        // Send initial hub property requests
        this._firstNotificationCallback = function () {
          console.log('ðŸ“¤ CompleteBLESpikePrimeHub: Sending initial hub requests...');
          self.sendMessage(0x01, [0x01, 0x02], false); // Name
          self.sendMessage(0x01, [0x03, 0x05], false); // Firmware
          self.sendMessage(0x01, [0x06, 0x05], false); // Battery
          console.log('âœ… CompleteBLESpikePrimeHub: Initial hub requests sent');
        };
        this._startPollingBatteryLevel();
      } catch (error) {
        console.error('âŒ CompleteBLESpikePrimeHub: SPIKE Prime communication setup failed:', error);
        throw error;
      }
    }
  }, {
    key: "_initializePythonREPL",
    value: function _initializePythonREPL() {
      console.log('ðŸ CompleteBLESpikePrimeHub: Initializing Python REPL...');

      // Send Ctrl-C to interrupt any running program
      this.sendRaw('\x03');
      var self = this;
      setTimeout(function () {
        console.log('ðŸ CompleteBLESpikePrimeHub: Confirming Python REPL availability...');
        self.sendRaw('import hub\r\nprint("PYTHON_AVAILABLE")\r\n');
      }, 500);
    }
  }, {
    key: "_startConnectionMonitoring",
    value: function _startConnectionMonitoring() {
      console.log('ðŸ’“ CompleteBLESpikePrimeHub: Starting connection monitoring...');
      if (this._keepAliveInterval) {
        clearInterval(this._keepAliveInterval);
      }
      var self = this;
      this._keepAliveInterval = setInterval(function () {
        var now = Date.now();
        var timeSinceLastMessage = now - self._lastHeartbeat;
        if (self.isConnected()) {
          console.log('ðŸ’“ CompleteBLESpikePrimeHub: Heartbeat - Last: ' + timeSinceLastMessage + 'ms, Method: ' + self._connectionMethod + ', Python: ' + self._pythonAvailable);
          if (timeSinceLastMessage > 10000) {
            // 10 seconds
            console.log('ðŸ“¡ CompleteBLESpikePrimeHub: Sending keep-alive...');
            self.sendMessage(0x01, [0x06, 0x05], false); // Battery request
          }
          if (timeSinceLastMessage > 25000) {
            // 25 seconds
            console.error('ðŸ’€ CompleteBLESpikePrimeHub: Connection timeout, recovering...');
            self._recoverConnection();
          }
        } else {
          console.warn('âš ï¸ CompleteBLESpikePrimeHub: Connection lost during monitoring');
          self._stopConnectionMonitoring();
        }
      }, 5000);
      console.log('âœ… CompleteBLESpikePrimeHub: Connection monitoring active');
    }
  }, {
    key: "_stopConnectionMonitoring",
    value: function _stopConnectionMonitoring() {
      if (this._keepAliveInterval) {
        console.log('â¹ï¸ CompleteBLESpikePrimeHub: Stopping connection monitoring');
        clearInterval(this._keepAliveInterval);
        this._keepAliveInterval = null;
      }
    }
  }, {
    key: "_recoverConnection",
    value: function _recoverConnection() {
      console.log('ðŸ”§ CompleteBLESpikePrimeHub: Attempting connection recovery...');
      if (this.isConnected()) {
        this.sendMessage(0x01, [0x01, 0x05], false); // Hub name request
      } else {
        console.log('ðŸ”„ CompleteBLESpikePrimeHub: Full reconnection needed');
        this.reset();
      }
    }

    // Enhanced message handling
  }, {
    key: "_onMessage",
    value: function _onMessage(params) {
      var timestamp = new Date().toLocaleTimeString();
      this._lastHeartbeat = Date.now();
      try {
        var text;
        var data;
        if (typeof params.message === 'string') {
          // BLE base64 message
          var Base64Util = require('../../../util/base64-util');
          data = Base64Util.base64ToUint8Array(params.message);
          text = new TextDecoder().decode(data);
          if (data.length >= 3) {
            var length = data[0];
            var messageType = data[2];
            var dataStr = Array.from(data.slice(0, Math.min(8, data.length))).map(function (b) {
              return '0x' + b.toString(16).padStart(2, '0');
            }).join(',');
            var suffix = data.length > 8 ? '...' : '';
            console.log('[' + timestamp + '] CompleteBLESpikePrimeHub: BLE MSG - Len:' + length + ', Type:0x' + messageType.toString(16) + ', Data:[' + dataStr + suffix + ']');

            // Process as LEGO BLE message
            _superPropGet(CompleteBLESpikePrimeHub, "_onMessage", this, 3)([params.message]);
            return;
          }
        } else {
          text = params.message;
        }

        // Process as Python REPL output
        var responses = (this._remainingText + text).split('\r\n');
        this._remainingText = responses.pop() || '';
        for (var i = 0; i < responses.length; i++) {
          var responseText = responses[i];
          var trimmedText = responseText.trim();
          if (!trimmedText) continue;
          console.log('[' + timestamp + '] CompleteBLESpikePrimeHub: PYTHON - "' + trimmedText + '"');

          // Try JSON parsing first
          try {
            var json = JSON.parse(trimmedText);
            this._parseJSONResponse(json);
          } catch (error) {
            // Process as raw Python output
            this._parsePythonData(trimmedText);
          }
        }
      } catch (error) {
        console.error('âŒ CompleteBLESpikePrimeHub: Message processing error:', error);
      }
    }
  }, {
    key: "_parsePythonData",
    value: function _parsePythonData(dataText) {
      try {
        if (dataText.indexOf('PYTHON_AVAILABLE') !== -1) {
          if (!this._pythonAvailable) {
            this._pythonAvailable = true;
            console.log('ðŸ CompleteBLESpikePrimeHub: Python REPL confirmed available!');
            this._initializeContinuousSensorMonitoring();
          }
        } else if (dataText.indexOf('SENSORS:') === 0) {
          this._parseSensorData(dataText.substring(8));
        } else if (dataText.indexOf('GESTURE:') === 0) {
          var gesture = dataText.substring(8).toLowerCase();
          if (this._sensors.gestures.hasOwnProperty(gesture)) {
            this._sensors.gestures[gesture] = true;
            var self = this;
            setTimeout(function () {
              self._sensors.gestures[gesture] = false;
            }, 100);
          }
        } else if (dataText.indexOf('>>>') === 0) {
          this._replOutput += dataText + '\n';
          if (this._replOutput.length > 1000) {
            this._replOutput = this._replOutput.substring(this._replOutput.length - 1000);
          }
        }
      } catch (error) {
        console.warn('âš ï¸ CompleteBLESpikePrimeHub: Error parsing Python data:', error);
      }
    }
  }, {
    key: "_parseSensorData",
    value: function _parseSensorData(sensorData) {
      try {
        var parts = sensorData.split('|');
        if (parts.length >= 5) {
          // Angles
          var angles = parts[0].split(',').map(parseFloat);
          if (angles.length === 3) {
            this._sensors.angle = {
              yaw: angles[0],
              pitch: angles[1],
              roll: angles[2]
            };
          }

          // Acceleration
          var accel = parts[1].split(',').map(parseFloat);
          if (accel.length === 3) {
            this._sensors.acceleration = {
              x: accel[0],
              y: accel[1],
              z: accel[2]
            };
          }

          // Orientation
          this._sensors.orientation = parseInt(parts[2], 10);

          // Temperatures
          var temps = parts[3].split(',').map(parseFloat);
          if (temps.length >= 2) {
            this._sensors.temperature = temps[0];
            this._sensors.hubTemp = temps[1];
          }

          // Motor positions
          if (parts[4]) {
            var motorPairs = parts[4].split('|');
            for (var i = 0; i < motorPairs.length; i++) {
              var pair = motorPairs[i];
              var splitPair = pair.split(':');
              var port = splitPair[0];
              var values = splitPair[1];
              if (port && values) {
                var motorValues = values.split(',').map(parseFloat);
                var speed = motorValues[0];
                var relDeg = motorValues[1];
                var absDeg = motorValues[2];
                var pwm = motorValues[3];
                this._sensors.motorPositions[port] = {
                  speed: speed,
                  relativePosition: relDeg,
                  absolutePosition: absDeg,
                  power: pwm
                };
              }
            }
          }
        }
      } catch (error) {
        console.warn('âš ï¸ CompleteBLESpikePrimeHub: Error parsing sensor data:', error);
      }
    }
  }, {
    key: "_parseJSONResponse",
    value: function _parseJSONResponse(response) {
      // Handle JSON-RPC responses
      if (response.hasOwnProperty('i')) {
        var openRequest = this._openRequests[response.i];
        if (openRequest) {
          openRequest.resolve(response.r);
          delete this._openRequests[response.i];
        }
      }
      if (response.hasOwnProperty('m')) {
        // Handle hub status messages
        this._parseHubStatusResponse(response);
      }
    }
  }, {
    key: "_parseHubStatusResponse",
    value: function _parseHubStatusResponse(response) {
      // Hub status parsing
      if (response.m === 0 && response.p) {
        // Port data parsing
        for (var i = 0; i < 6 && i < response.p.length; i++) {
          var port = SpikePorts[i];
          if (response.p[i] && response.p[i].length >= 2) {
            var deviceId = response.p[i][0];
            var values = response.p[i][1];
            switch (deviceId) {
              case 48: // Large motor
              case 49:
                // Medium motor
                this._portValues[port] = {
                  type: 'motor',
                  speed: values[0] || 0,
                  degreesCounted: values[1] || 0,
                  position: ((values[2] || 0) + 360) % 360,
                  power: values[3] || 0,
                  relativePosition: values[1] || 0,
                  absolutePosition: values[2] || 0
                };
                break;
              case 61:
                // Color sensor
                this._portValues[port] = {
                  type: 'color',
                  color: values[0] || 0,
                  reflection: values[1] || 0,
                  ambient: values[2] || 0
                };
                break;
              case 62:
                // Distance sensor
                this._portValues[port] = {
                  type: 'distance',
                  distance: values[0] === -1 ? 0 : values[0] || 0
                };
                break;
              case 63:
                // Force sensor
                this._portValues[port] = {
                  type: 'force',
                  force: values[0] || 0,
                  pressed: (values[1] || 0) > 0
                };
                break;
            }
          }
        }
      }
    }
  }, {
    key: "_initializeContinuousSensorMonitoring",
    value: function _initializeContinuousSensorMonitoring() {
      if (this._sensorLoopRunning) return;
      this._sensorLoopRunning = true;
      console.log('ðŸ”„ CompleteBLESpikePrimeHub: Starting continuous sensor monitoring...');

      // Sensor monitoring script
      var sensorScript = 'import hub, utime\n' + 'def continuous_sensor_loop():\n' + '    while True:\n' + '        try:\n' + '            yaw_angle, pitch_angle, roll_angle = hub.motion.position()\n' + '            accel_x, accel_y, accel_z = hub.motion.accelerometer()\n' + '            orientation = hub.motion.orientation()\n' + '            battery_temp = hub.battery.temperature()\n' + '            hub_temp = hub.temperature()\n' + '            motor_data = {}\n' + '            for port in "ABCDEF":\n' + '                if hasattr(hub.port[port], "motor"):\n' + '                    try:\n' + '                        speed, rel_deg, abs_deg, pwm = hub.port[port].motor.get()\n' + '                        motor_data[port] = f"{speed},{rel_deg},{abs_deg},{pwm}"\n' + '                    except: pass\n' + '            motor_str = "|".join([f"{k}:{v}" for k, v in motor_data.items()])\n' + '            print(f"SENSORS:{yaw_angle},{pitch_angle},{roll_angle}|{accel_x},{accel_y},{accel_z}|{orientation}|{battery_temp},{hub_temp}|{motor_str}")\n' + '            for gesture in ["tapped", "doubletapped", "shake", "freefall"]:\n' + '                if hub.motion.was_gesture(gesture):\n' + '                    print(f"GESTURE:{gesture.upper()}")\n' + '        except Exception as e:\n' + '            pass\n' + '        utime.sleep_ms(100)\n' + 'continuous_sensor_loop()\n';
      this.sendPythonCommand(sensorScript);
    }

    // Enhanced send method
  }, {
    key: "send",
    value: function send(data, useLimiter) {
      if (useLimiter === undefined) useLimiter = true;
      var timestamp = new Date().toLocaleTimeString();
      if (!this.isConnected()) {
        console.warn('âš ï¸ CompleteBLESpikePrimeHub: Cannot send - not connected');
        return Promise.resolve();
      }
      if (useLimiter && !this._rateLimiter.okayToSend()) {
        console.log('â³ CompleteBLESpikePrimeHub: Rate limited');
        return Promise.resolve();
      }
      var dataStr = Array.from(data.slice(0, Math.min(6, data.length))).map(function (b) {
        return '0x' + b.toString(16).padStart(2, '0');
      }).join(',');
      var suffix = data.length > 6 ? '...' : '';
      console.log('[' + timestamp + '] CompleteBLESpikePrimeHub: SEND - Method:' + this._connectionMethod + ', Len:' + data.length + ', Data:[' + dataStr + suffix + ']');
      try {
        var serviceUUID = this._useSpikePrimeUUIDs ? SPIKE_PRIME_SERVICE_UUID : LEGO_SERVICE_UUID;
        var writeUUID = this._useSpikePrimeUUIDs ? SPIKE_PRIME_WRITE_UUID : LEGO_CHAR_UUID;
        var Base64Util = require('../../../util/base64-util');
        return this._ble.write(serviceUUID, writeUUID, Base64Util.uint8ArrayToBase64(data), 'base64', true).then(function () {
          console.log('âœ… CompleteBLESpikePrimeHub: Data sent successfully');
        }).catch(function (error) {
          console.error('âŒ CompleteBLESpikePrimeHub: Send failed:', error);
          throw error;
        });
      } catch (error) {
        console.error('âŒ CompleteBLESpikePrimeHub: Send setup failed:', error);
        return Promise.reject(error);
      }
    }

    // Python communication methods
  }, {
    key: "sendRaw",
    value: function sendRaw(text, useLimiter, id) {
      if (!this.isConnected()) return Promise.resolve();
      console.log('ðŸ CompleteBLESpikePrimeHub: Sending raw Python: "' + text.replace(/\r\n/g, '\\r\\n') + '"');
      if (id) {
        var self = this;
        var promise = new Promise(function (resolve, reject) {
          self._openRequests[id] = {
            resolve: resolve,
            reject: reject
          };
        });
        this._sendRawMessage(text);
        return promise;
      }
      return this._sendRawMessage(text);
    }
  }, {
    key: "sendPythonCommand",
    value: function sendPythonCommand(pythonCode) {
      var codePreview = pythonCode.substring(0, 100);
      var suffix = pythonCode.length > 100 ? '...' : '';
      console.log('ðŸ CompleteBLESpikePrimeHub: Python command: ' + codePreview + suffix);
      return this.sendRaw(pythonCode + '\r\n');
    }
  }, {
    key: "sendReplCommand",
    value: function sendReplCommand(pythonCode) {
      this._replHistory.push(pythonCode);
      if (this._replHistory.length > 50) {
        this._replHistory.shift();
      }
      var escapedCode = pythonCode.replace(/"/g, '\\"');
      var wrappedCode = 'try:\n' + '    _result = eval("' + escapedCode + '")\n' + '    if _result is not None:\n' + '        print(f">>> {_result}")\n' + '    else:\n' + '        exec("' + escapedCode + '")\n' + '        print(">>> Command executed")\n' + 'except Exception as e:\n' + '    print(f">>> Error: {e}")\n';
      return this.sendPythonCommand(wrappedCode);
    }
  }, {
    key: "_sendRawMessage",
    value: function _sendRawMessage(text) {
      // For BLE, send as binary data
      var encoder = new TextEncoder();
      var data = encoder.encode(text);
      return this.send(data, false);
    }

    // Utility methods
  }, {
    key: "_clamp",
    value: function _clamp(value, min, max) {
      return Math.max(min, Math.min(max, value));
    }

    // Override reset
  }, {
    key: "reset",
    value: function reset() {
      console.log('ðŸ”„ CompleteBLESpikePrimeHub: Comprehensive reset...');
      this._connected = false;
      this._pythonAvailable = false;
      this._sensorLoopRunning = false;
      this._useSpikePrimeUUIDs = true;
      this._remainingText = '';
      this._replOutput = '';
      this._replHistory = [];
      this._openRequests = {};
      this._stopConnectionMonitoring();

      // Reset sensors
      this._sensors = {
        buttons: [0, 0, 0, 0],
        angle: {
          pitch: 0,
          roll: 0,
          yaw: 0
        },
        acceleration: {
          x: 0,
          y: 0,
          z: 0
        },
        gyro: {
          x: 0,
          y: 0,
          z: 0
        },
        orientation: SpikeOrientation.front,
        battery: 100,
        temperature: 25,
        hubTemp: 25,
        gestures: {
          tapped: false,
          doubletapped: false,
          shake: false,
          freefall: false
        },
        motorPositions: {}
      };
      this._portValues = {};
      this._timer.start = Date.now();
      this._timer.current = 0;
      console.log('ðŸ“Š CompleteBLESpikePrimeHub: Reset stats - Attempts:' + this._connectionAttempts + ', Method:' + this._connectionMethod);
      _superPropGet(CompleteBLESpikePrimeHub, "reset", this, 3)([]);
      console.log('âœ… CompleteBLESpikePrimeHub: Reset complete');
    }

    // Override isConnected
  }, {
    key: "isConnected",
    value: function isConnected() {
      var connected = this._connected && _superPropGet(CompleteBLESpikePrimeHub, "isConnected", this, 3)([]);
      if (Math.random() < 0.01) {
        // 1% logging
        console.log('ðŸ” CompleteBLESpikePrimeHub: Status - Connected:' + connected + ', Python:' + this._pythonAvailable + ', Method:' + this._connectionMethod);
      }
      return connected;
    }

    // Control methods
  }, {
    key: "stopAll",
    value: function stopAll() {
      this.stopAllMotors();
      this.stopSound();
    }
  }, {
    key: "stopSound",
    value: function stopSound() {
      this.sendPythonCommand('import hub; hub.sound.stop()');
    }
  }, {
    key: "stopAllMotors",
    value: function stopAllMotors() {
      this.sendPythonCommand('import hub; [hub.port[p].motor.stop() for p in "ABCDEF" if hasattr(hub.port[p], "motor")]');
    }
  }]);
}(Hub); // Main Extension Class
var Scratch3SpikePrimeBlocks = /*#__PURE__*/function (_BleBaseBlocks) {
  function Scratch3SpikePrimeBlocks(runtime) {
    var _this2;
    _classCallCheck(this, Scratch3SpikePrimeBlocks);
    console.log('ðŸŽ¯ Scratch3SpikePrimeBlocks: Initializing BLE SPIKE Prime extension...');

    // Use the complete BLE SPIKE Prime hub
    _this2 = _callSuper(this, Scratch3SpikePrimeBlocks, [new CompleteBLESpikePrimeHub(runtime, Scratch3SpikePrimeBlocks.EXTENSION_ID)]);
    if (runtime.formatMessage) {
      formatMessage = runtime.formatMessage;
    }
    console.log('âœ… Scratch3SpikePrimeBlocks: BLE extension initialized');
    return _this2;
  }
  _inherits(Scratch3SpikePrimeBlocks, _BleBaseBlocks);
  return _createClass(Scratch3SpikePrimeBlocks, [{
    key: "externalPorts",
    get: function get() {
      return SpikePorts;
    }
  }, {
    key: "multipleExternalPorts",
    get: function get() {
      return ['A', 'B', 'C', 'D', 'E', 'F', 'A+B', 'C+D', 'E+F', 'A+B+C+D+E+F'];
    }
  }, {
    key: "hasInternalTiltSensorBlocks",
    get: function get() {
      return true;
    }
  }, {
    key: "hasAdvancedBlocks",
    get: function get() {
      return true;
    }
  }, {
    key: "setupTranslations",
    value: function setupTranslations(formatMessage) {
      var localeSetup = formatMessage.setup();
      var translations = {
        'en': {
          'spikeprime.motorStart': '[PORT] start motor [DIRECTION]',
          'spikeprime.motorStop': '[PORT] stop motor',
          'spikeprime.motorSetSpeed': '[PORT] set speed to [SPEED] %',
          'spikeprime.getPosition': '[PORT] position',
          'spikeprime.displayText': 'write [TEXT]',
          'spikeprime.displayImage': 'turn on [MATRIX]',
          'spikeprime.displayClear': 'turn off pixels',
          'spikeprime.getDistance': '[PORT] distance',
          'spikeprime.getColor': '[PORT] color',
          'spikeprime.getAngle': '[AXIS] angle',
          'spikeprime.isGesture': 'hub [GESTURE]?',
          'spikeprime.playBeep': 'beep [FREQUENCY] Hz for [DURATION] ms',
          'spikeprime.getBatteryLevel': 'battery level %',
          'spikeprime.isButtonPressed': '[BUTTON] button pressed?',
          'spikeprime.runPythonCommand': 'run Python: [CODE]'
        },
        'de': {
          'spikeprime.motorStart': '[PORT] Motor [DIRECTION] starten',
          'spikeprime.motorStop': '[PORT] Motor stoppen',
          'spikeprime.motorSetSpeed': '[PORT] Geschwindigkeit auf [SPEED] % setzen',
          'spikeprime.getPosition': '[PORT] Position',
          'spikeprime.displayText': '[TEXT] schreiben',
          'spikeprime.displayImage': '[MATRIX] einschalten',
          'spikeprime.displayClear': 'Pixel ausschalten',
          'spikeprime.getDistance': '[PORT] Entfernung',
          'spikeprime.getColor': '[PORT] Farbe',
          'spikeprime.getAngle': '[AXIS] Winkel',
          'spikeprime.isGesture': 'Hub [GESTURE]?',
          'spikeprime.playBeep': '[FREQUENCY] Hz Piep fÃ¼r [DURATION] ms',
          'spikeprime.getBatteryLevel': 'Batteriestand %',
          'spikeprime.isButtonPressed': '[BUTTON] Taste gedrÃ¼ckt?',
          'spikeprime.runPythonCommand': 'Python ausfÃ¼hren: [CODE]',
          // Menu item translations
          'spikeprime.pitch': 'Neigung',
          'spikeprime.roll': 'Rollen',
          'spikeprime.yaw': 'Gieren',
          'spikeprime.tapped': 'angetippt',
          'spikeprime.doubletapped': 'doppelt angetippt',
          'spikeprime.shake': 'geschÃ¼ttelt',
          'spikeprime.freefall': 'freier Fall',
          'spikeprime.left': 'links',
          'spikeprime.center': 'mitte',
          'spikeprime.right': 'rechts'
        }
      };
      for (var locale in translations) {
        if (!localeSetup.translations[locale]) {
          localeSetup.translations[locale] = {};
        }
        Object.assign(localeSetup.translations[locale], translations[locale]);
      }
    }
  }, {
    key: "getInfo",
    value: function getInfo() {
      this.setupTranslations(formatMessage);
      return {
        id: Scratch3SpikePrimeBlocks.EXTENSION_ID,
        name: 'SPIKE Prime BLE',
        extensionURL: Scratch3SpikePrimeBlocks.extensionURL,
        blockIconURI: blockIconURI,
        showStatusButton: true,
        blocks: [
        // Motor Control
        {
          opcode: 'motorStart',
          text: formatMessage({
            id: 'spikeprime.motorStart',
            default: '[PORT] start motor [DIRECTION]'
          }),
          blockType: this.getBlockType('COMMAND'),
          arguments: {
            PORT: {
              type: this.getArgumentType('STRING'),
              menu: 'MULTIPLE_PORT',
              defaultValue: 'A'
            },
            DIRECTION: {
              type: this.getArgumentType('NUMBER'),
              menu: 'DIRECTION',
              defaultValue: 1
            }
          }
        }, {
          opcode: 'motorStop',
          text: formatMessage({
            id: 'spikeprime.motorStop',
            default: '[PORT] stop motor'
          }),
          blockType: this.getBlockType('COMMAND'),
          arguments: {
            PORT: {
              type: this.getArgumentType('STRING'),
              menu: 'MULTIPLE_PORT',
              defaultValue: 'A'
            }
          }
        }, {
          opcode: 'motorSetSpeed',
          text: formatMessage({
            id: 'spikeprime.motorSetSpeed',
            default: '[PORT] set speed to [SPEED] %'
          }),
          blockType: this.getBlockType('COMMAND'),
          arguments: {
            PORT: {
              type: this.getArgumentType('STRING'),
              menu: 'MULTIPLE_PORT',
              defaultValue: 'A'
            },
            SPEED: {
              type: this.getArgumentType('NUMBER'),
              defaultValue: 75
            }
          }
        }, {
          opcode: 'getPosition',
          text: formatMessage({
            id: 'spikeprime.getPosition',
            default: '[PORT] position'
          }),
          blockType: this.getBlockType('REPORTER'),
          arguments: {
            PORT: {
              type: this.getArgumentType('STRING'),
              menu: 'PORT',
              defaultValue: 'A'
            }
          }
        }, '---',
        // Display Control
        {
          opcode: 'displayText',
          text: formatMessage({
            id: 'spikeprime.displayText',
            default: 'write [TEXT]'
          }),
          blockType: this.getBlockType('COMMAND'),
          arguments: {
            TEXT: {
              type: this.getArgumentType('STRING'),
              defaultValue: 'Hello'
            }
          }
        }, {
          opcode: 'displayImage',
          text: formatMessage({
            id: 'spikeprime.displayImage',
            default: 'turn on [MATRIX]'
          }),
          blockType: this.getBlockType('COMMAND'),
          arguments: {
            MATRIX: {
              type: this.getArgumentType('MATRIX'),
              defaultValue: '1101111011000001000101110'
            }
          }
        }, {
          opcode: 'displayClear',
          text: formatMessage({
            id: 'spikeprime.displayClear',
            default: 'turn off pixels'
          }),
          blockType: this.getBlockType('COMMAND')
        }, '---',
        // Sensors
        {
          opcode: 'getDistance',
          text: formatMessage({
            id: 'spikeprime.getDistance',
            default: '[PORT] distance'
          }),
          blockType: this.getBlockType('REPORTER'),
          arguments: {
            PORT: {
              type: this.getArgumentType('STRING'),
              menu: 'PORT',
              defaultValue: 'A'
            }
          }
        }, {
          opcode: 'getColor',
          text: formatMessage({
            id: 'spikeprime.getColor',
            default: '[PORT] color'
          }),
          blockType: this.getBlockType('REPORTER'),
          arguments: {
            PORT: {
              type: this.getArgumentType('STRING'),
              menu: 'PORT',
              defaultValue: 'A'
            }
          }
        }, {
          opcode: 'getAngle',
          text: formatMessage({
            id: 'spikeprime.getAngle',
            default: '[AXIS] angle'
          }),
          blockType: this.getBlockType('REPORTER'),
          arguments: {
            AXIS: {
              type: this.getArgumentType('STRING'),
              menu: 'AXIS',
              defaultValue: 'pitch'
            }
          }
        }, {
          opcode: 'isGesture',
          text: formatMessage({
            id: 'spikeprime.isGesture',
            default: 'hub [GESTURE]?'
          }),
          blockType: this.getBlockType('BOOLEAN'),
          arguments: {
            GESTURE: {
              type: this.getArgumentType('STRING'),
              menu: 'GESTURE',
              defaultValue: 'tapped'
            }
          }
        }, '---',
        // Sound
        {
          opcode: 'playBeep',
          text: formatMessage({
            id: 'spikeprime.playBeep',
            default: 'beep [FREQUENCY] Hz for [DURATION] ms'
          }),
          blockType: this.getBlockType('COMMAND'),
          arguments: {
            FREQUENCY: {
              type: this.getArgumentType('NUMBER'),
              defaultValue: 440
            },
            DURATION: {
              type: this.getArgumentType('NUMBER'),
              defaultValue: 500
            }
          }
        }, '---',
        // Status
        {
          opcode: 'getBatteryLevel',
          text: formatMessage({
            id: 'spikeprime.getBatteryLevel',
            default: 'battery level %'
          }),
          blockType: this.getBlockType('REPORTER')
        }, {
          opcode: 'isButtonPressed',
          text: formatMessage({
            id: 'spikeprime.isButtonPressed',
            default: '[BUTTON] button pressed?'
          }),
          blockType: this.getBlockType('BOOLEAN'),
          arguments: {
            BUTTON: {
              type: this.getArgumentType('STRING'),
              menu: 'BUTTON',
              defaultValue: 'center'
            }
          }
        }, '---',
        // Python
        {
          opcode: 'runPythonCommand',
          text: formatMessage({
            id: 'spikeprime.runPythonCommand',
            default: 'run Python: [CODE]'
          }),
          blockType: this.getBlockType('COMMAND'),
          arguments: {
            CODE: {
              type: this.getArgumentType('STRING'),
              defaultValue: 'print("Hello BLE!")'
            }
          }
        }],
        menus: {
          PORT: {
            acceptReporters: true,
            items: SpikePorts
          },
          MULTIPLE_PORT: {
            acceptReporters: true,
            items: ['A', 'B', 'C', 'D', 'E', 'F', 'A+B', 'C+D', 'E+F']
          },
          DIRECTION: {
            acceptReporters: false,
            items: [{
              text: 'â¬†ï¸',
              value: '1'
            }, {
              text: 'â¬‡ï¸',
              value: '-1'
            }]
          },
          AXIS: {
            acceptReporters: false,
            items: [{
              text: formatMessage({
                id: 'spikeprime.pitch',
                default: 'pitch'
              }),
              value: 'pitch'
            }, {
              text: formatMessage({
                id: 'spikeprime.roll',
                default: 'roll'
              }),
              value: 'roll'
            }, {
              text: formatMessage({
                id: 'spikeprime.yaw',
                default: 'yaw'
              }),
              value: 'yaw'
            }]
          },
          GESTURE: {
            acceptReporters: false,
            items: [{
              text: formatMessage({
                id: 'spikeprime.tapped',
                default: 'tapped'
              }),
              value: 'tapped'
            }, {
              text: formatMessage({
                id: 'spikeprime.doubletapped',
                default: 'doubletapped'
              }),
              value: 'doubletapped'
            }, {
              text: formatMessage({
                id: 'spikeprime.shake',
                default: 'shake'
              }),
              value: 'shake'
            }, {
              text: formatMessage({
                id: 'spikeprime.freefall',
                default: 'freefall'
              }),
              value: 'freefall'
            }]
          },
          BUTTON: {
            acceptReporters: false,
            items: [{
              text: formatMessage({
                id: 'spikeprime.left',
                default: 'left'
              }),
              value: 'left'
            }, {
              text: formatMessage({
                id: 'spikeprime.center',
                default: 'center'
              }),
              value: 'center'
            }, {
              text: formatMessage({
                id: 'spikeprime.right',
                default: 'right'
              }),
              value: 'right'
            }]
          }
        }
      };
    }

    // Helper methods
  }, {
    key: "getBlockType",
    value: function getBlockType(type) {
      try {
        var BlockType = require('../../extension-support/block-type');
        return BlockType[type];
      } catch (e) {
        return type.toLowerCase();
      }
    }
  }, {
    key: "getArgumentType",
    value: function getArgumentType(type) {
      try {
        var ArgumentType = require('../../extension-support/argument-type');
        return ArgumentType[type];
      } catch (e) {
        return type.toLowerCase();
      }
    }
  }, {
    key: "getCast",
    value: function getCast() {
      try {
        return require('../../util/cast');
      } catch (e) {
        return {
          toString: function toString(value) {
            return String(value);
          },
          toNumber: function toNumber(value) {
            return Number(value) || 0;
          }
        };
      }
    }

    // Block implementations
  }, {
    key: "motorStart",
    value: function motorStart(args) {
      var direction = this.getCast().toNumber(args.DIRECTION);
      var ports = this._validatePorts(this.getCast().toString(args.PORT));
      var self = this;
      var promises = ports.map(function (port) {
        var setting = self._peripheral.motorSettings[port];
        return self._peripheral.sendPythonCommand('import hub; hub.port.' + port + '.motor.pwm(' + Math.round(setting.speed * direction) + ')');
      });
      return Promise.all(promises);
    }
  }, {
    key: "motorStop",
    value: function motorStop(args) {
      var ports = this._validatePorts(this.getCast().toString(args.PORT));
      var self = this;
      var promises = ports.map(function (port) {
        return self._peripheral.sendPythonCommand('import hub; hub.port.' + port + '.motor.stop()');
      });
      return Promise.all(promises);
    }
  }, {
    key: "motorSetSpeed",
    value: function motorSetSpeed(args) {
      var speed = this.getCast().toNumber(args.SPEED);
      var ports = this._validatePorts(this.getCast().toString(args.PORT));
      var self = this;
      ports.forEach(function (port) {
        self._peripheral.motorSettings[port].speed = speed;
      });
    }
  }, {
    key: "getPosition",
    value: function getPosition(args) {
      var port = this.getCast().toString(args.PORT).trim().toUpperCase();
      var portData = this._peripheral.portValues[port];
      return portData && portData.position ? portData.position : 0;
    }
  }, {
    key: "displayText",
    value: function displayText(args) {
      var text = this.getCast().toString(args.TEXT);
      var escapedText = text.replace(/"/g, '\\"');
      return this._peripheral.sendPythonCommand('import hub; hub.display.show("' + escapedText + '")');
    }
  }, {
    key: "displayImage",
    value: function displayImage(args) {
      var matrix = this.getCast().toString(args.MATRIX);
      Math.round(9 * this._peripheral.pixelBrightness / 100);
      var symbol = (matrix.replace(/\D/g, '') + '0'.repeat(25)).slice(0, 25);
      var altImage = symbol.replace(/1/g, '9').replace(/0/g, '_').match(/.{5}/g).join(':');
      return this._peripheral.sendPythonCommand('import hub; hub.display.show(hub.Image("' + altImage + '"))');
    }
  }, {
    key: "displayClear",
    value: function displayClear() {
      return this._peripheral.sendPythonCommand('import hub; hub.display.clear()');
    }
  }, {
    key: "getDistance",
    value: function getDistance(args) {
      var port = this.getCast().toString(args.PORT).trim().toUpperCase();
      var portData = this._peripheral.portValues[port];
      return portData && portData.type === 'distance' ? portData.distance : 0;
    }
  }, {
    key: "getColor",
    value: function getColor(args) {
      var port = this.getCast().toString(args.PORT).trim().toUpperCase();
      var portData = this._peripheral.portValues[port];
      if (portData && portData.type === 'color') {
        var colorNames = ['black', 'magenta', 'purple', 'blue', 'azure', 'turquoise', 'green', 'yellow', 'orange', 'red', 'white'];
        return colorNames[portData.color] || 'none';
      }
      return 'none';
    }
  }, {
    key: "getAngle",
    value: function getAngle(args) {
      var axis = this.getCast().toString(args.AXIS);
      return this._peripheral.angle[axis] || 0;
    }
  }, {
    key: "isGesture",
    value: function isGesture(args) {
      var gesture = this.getCast().toString(args.GESTURE);
      return this._peripheral.gestures[gesture] || false;
    }
  }, {
    key: "playBeep",
    value: function playBeep(args) {
      var frequency = this.getCast().toNumber(args.FREQUENCY);
      var duration = this.getCast().toNumber(args.DURATION);
      return this._peripheral.sendPythonCommand('import hub; hub.sound.beep(' + frequency + ', ' + duration + ')');
    }
  }, {
    key: "getBatteryLevel",
    value: function getBatteryLevel() {
      return this._peripheral.battery || 100;
    }
  }, {
    key: "isButtonPressed",
    value: function isButtonPressed(args) {
      var button = this.getCast().toString(args.BUTTON);
      var buttonIndex = {
        left: 0,
        center: 1,
        right: 2
      }[button];
      return buttonIndex !== undefined ? this._peripheral._sensors.buttons[buttonIndex] === 1 : false;
    }
  }, {
    key: "runPythonCommand",
    value: function runPythonCommand(args) {
      var code = this.getCast().toString(args.CODE);
      return this._peripheral.sendPythonCommand(code);
    }
  }, {
    key: "_validatePorts",
    value: function _validatePorts(text) {
      return text.toUpperCase().replace(/[^ABCDEF]/g, '').split('').filter(function (x, i, self) {
        return self.indexOf(x) === i;
      }).sort();
    }
  }], [{
    key: "EXTENSION_ID",
    get: function get() {
      return 'spikeprime';
    }
  }, {
    key: "extensionURL",
    get: function get() {
      return extensionURL;
    },
    set: function set(url) {
      extensionURL = url;
    }
  }]);
}(BleBaseBlocks); // Generated ES Module export
var blockClass = Scratch3SpikePrimeBlocks;
blockClass = Scratch3SpikePrimeBlocks;

export { blockClass, entry };
